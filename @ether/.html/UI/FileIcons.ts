// ============================================================
// FileIcons.ts â€” SVG icon map by file extension
// ============================================================

const svg = (body: string, color: string) =>
  `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16" fill="${color}">${body}</svg>`;

const FOLDER = svg(
  `<path d="M1.5 1A1.5 1.5 0 000 2.5v11A1.5 1.5 0 001.5 15h13a1.5 1.5 0 001.5-1.5V4.5A1.5 1.5 0 0014.5 3H7.71L6.15 1.44A1.5 1.5 0 005.06 1H1.5z"/>`,
  '#8da0cb'
);

const FILE_GENERIC = svg(
  `<path d="M3.5 1A1.5 1.5 0 002 2.5v11A1.5 1.5 0 003.5 15h9a1.5 1.5 0 001.5-1.5V6l-4.5-5H3.5zM10 1.5L13.5 5.5H10.5A.5.5 0 0110 5V1.5z"/>`,
  '#8b8b8b'
);

const icons: Record<string, string> = {
  md: svg(
    `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path d="M593.8 123.1L46.2 123.1C20.7 123.1 0 143.8 0 169.2L0 470.7C0 496.2 20.7 516.9 46.2 516.9L593.9 516.9C619.4 516.9 640.1 496.2 640 470.8L640 169.2C640 143.8 619.3 123.1 593.8 123.1zM338.5 424.6L277 424.6L277 304.6L215.5 381.5L154 304.6L154 424.6L92.3 424.6L92.3 215.4L153.8 215.4L215.3 292.3L276.8 215.4L338.3 215.4L338.3 424.6L338.5 424.6zM473.8 427.7L381.5 320L443 320L443 215.4L504.5 215.4L504.5 320L566 320L473.8 427.7z"/></svg>`,
    '#519aba'
  ),
  ts: svg(
    `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path d="M112.8 96L527.2 96C536.5 96 544 103.5 544 112.8L544 527.2C544 536.5 536.5 544 527.2 544L112.8 544C103.5 544 96 536.5 96 527.2L96 112.8C96 103.5 103.5 96 112.8 96zM345 334.3L345 297.6L185.6 297.6L185.6 334.3L242.5 334.3L242.5 497.9L287.8 497.9L287.8 334.3L345 334.3zM363.1 493.6C370.4 497.3 379 500.1 389 502C399 503.9 409.5 504.8 420.5 504.8C431.3 504.8 441.5 503.8 451.2 501.7C460.9 499.6 469.4 496.3 476.7 491.6C484 486.9 489.8 480.7 494.1 473.2C498.4 465.7 500.5 456.2 500.5 445C500.5 436.9 499.3 429.8 496.8 423.7C494.3 417.6 490.9 412.2 486.3 407.4C481.7 402.6 476.2 398.4 469.8 394.6C463.4 390.8 456.1 387.3 448.1 383.9C442.2 381.5 436.9 379.1 432.2 376.8C427.5 374.5 423.5 372.2 420.3 369.8C417.1 367.4 414.5 364.9 412.7 362.3C410.9 359.7 410 356.6 410 353.3C410 350.2 410.8 347.5 412.4 345C414 342.5 416.2 340.4 419.1 338.6C422 336.8 425.6 335.5 429.8 334.5C434 333.5 438.7 333 443.9 333C447.6 333 451.6 333.3 455.8 333.8C460 334.3 464.2 335.2 468.4 336.4C472.6 337.6 476.7 339 480.7 340.8C484.7 342.6 488.4 344.6 491.7 346.9L491.7 305.1C484.9 302.5 477.4 300.6 469.3 299.3C461.2 298 451.9 297.4 441.4 297.4C430.7 297.4 420.6 298.5 411 300.8C401.4 303.1 393 306.6 385.8 311.5C378.6 316.4 372.8 322.5 368.6 330C364.4 337.5 362.3 346.5 362.3 356.9C362.3 370.2 366.2 381.6 373.9 391C381.6 400.4 393.4 408.4 409.1 414.9C415.3 417.4 421 419.9 426.4 422.3C431.8 424.7 436.4 427.2 440.2 429.8C444 432.4 447.2 435.2 449.4 438.3C451.6 441.4 452.8 444.9 452.8 448.8C452.8 451.7 452.1 454.4 450.7 456.8C449.3 459.2 447.2 461.4 444.3 463.2C441.4 465 437.9 466.4 433.6 467.5C429.3 468.6 424.3 469 418.6 469C408.9 469 399.2 467.3 389.7 463.9C380.2 460.5 371.3 455.4 363.1 448.6L363.1 493.3z"/></svg>`,
    '#3178c6'
  ),
  js: svg(
    `<path d="M0 2.5A1.5 1.5 0 011.5 1h13A1.5 1.5 0 0116 2.5v11a1.5 1.5 0 01-1.5 1.5h-13A1.5 1.5 0 010 13.5v-11zM5.2 11.3c.65.4 1.35.6 2 .6 1.15 0 1.8-.6 1.8-1.7V5.5H7.6v4.62c0 .5-.22.72-.6.72-.35 0-.55-.14-.8-.38L5.2 11.3zm4.4-.14c.72.5 1.5.74 2.38.74 1.38 0 2.32-.68 2.32-1.82 0-1.08-.65-1.55-1.78-2.02l-.38-.16c-.58-.25-.82-.42-.82-.82 0-.32.25-.57.64-.57.38 0 .62.16.85.57l.95-.6c-.42-.72-1-.99-1.8-.99-1.14 0-1.86.72-1.86 1.68 0 1.04.62 1.53 1.56 1.92l.38.16c.62.28.98.44.98.92 0 .4-.36.68-.93.68-.68 0-1.06-.35-1.38-.82l-1.01.55z"/>`,
    '#f0db4f'
  ),
  json: svg(
    `<path d="M2 2.5A1.5 1.5 0 013.5 1h9A1.5 1.5 0 0114 2.5v11a1.5 1.5 0 01-1.5 1.5h-9A1.5 1.5 0 012 12.5v-11zM5.5 4.5c-.83 0-1.5.67-1.5 1.5v1c0 .55-.45 1-1 1v1c.55 0 1 .45 1 1v1c0 .83.67 1.5 1.5 1.5H6v-1h-.5a.5.5 0 01-.5-.5V9.5c0-.55-.22-1.05-.59-1.5.37-.45.59-.95.59-1.5V6a.5.5 0 01.5-.5H6v-1h-.5zM10 4.5v1h.5a.5.5 0 01.5.5v.5c0 .55.22 1.05.59 1.5-.37.45-.59.95-.59 1.5v1a.5.5 0 01-.5.5H10v1h.5c.83 0 1.5-.67 1.5-1.5v-1c0-.55.45-1 1-1v-1c-.55 0-1-.45-1-1v-1c0-.83-.67-1.5-1.5-1.5H10z"/>`,
    '#a9a038'
  ),
  css: svg(
    `<path d="M0 2.5A1.5 1.5 0 011.5 1h13A1.5 1.5 0 0116 2.5v11a1.5 1.5 0 01-1.5 1.5h-13A1.5 1.5 0 010 13.5v-11zM4.8 5.2L3 6.8l1.8 1.6.9-1L4.5 6.8l1.2-.6-.9-1zm6.4 0l-.9 1 1.2.6-1.2.6.9 1L13 6.8l-1.8-1.6zM6.8 10.5l1.5-5.3h1.4l-1.5 5.3H6.8z"/>`,
    '#56b3b4'
  ),
  html: svg(
    `<path d="M0 2.5A1.5 1.5 0 011.5 1h13A1.5 1.5 0 0116 2.5v11a1.5 1.5 0 01-1.5 1.5h-13A1.5 1.5 0 010 13.5v-11zM3.5 5L2 8l1.5 3h1.2L3.3 8l1.4-3H3.5zM11.3 5L12.7 8l-1.4 3h1.2L14 8l-1.5-3h-1.2zM6.8 11l1.5-6h1.4l-1.5 6H6.8z"/>`,
    '#e44d26'
  ),
  svg: svg(
    `<path d="M3.5 1A1.5 1.5 0 002 2.5v11A1.5 1.5 0 003.5 15h9a1.5 1.5 0 001.5-1.5V6l-4.5-5H3.5zM10 1.5L13.5 5.5H10.5A.5.5 0 0110 5V1.5zM8 7a3 3 0 100 6 3 3 0 000-6z"/>`,
    '#e69d2a'
  ),
  png: svg(
    `<path d="M3.5 1A1.5 1.5 0 002 2.5v11A1.5 1.5 0 003.5 15h9a1.5 1.5 0 001.5-1.5V6l-4.5-5H3.5zM10 1.5L13.5 5.5H10.5A.5.5 0 0110 5V1.5zM4 9l2-2 1.5 1.5L10 6l3 4H4z"/>`,
    '#26a269'
  ),
  jpg: svg(
    `<path d="M3.5 1A1.5 1.5 0 002 2.5v11A1.5 1.5 0 003.5 15h9a1.5 1.5 0 001.5-1.5V6l-4.5-5H3.5zM10 1.5L13.5 5.5H10.5A.5.5 0 0110 5V1.5zM4 9l2-2 1.5 1.5L10 6l3 4H4z"/>`,
    '#26a269'
  ),
  txt: svg(
    `<path d="M3.5 1A1.5 1.5 0 002 2.5v11A1.5 1.5 0 003.5 15h9a1.5 1.5 0 001.5-1.5V6l-4.5-5H3.5zM10 1.5L13.5 5.5H10.5A.5.5 0 0110 5V1.5zM4 8h8v1H4V8zm0 2h5v1H4v-1z"/>`,
    '#8b8b8b'
  ),
  py: svg(
    `<path d="M0 2.5A1.5 1.5 0 011.5 1h13A1.5 1.5 0 0116 2.5v11a1.5 1.5 0 01-1.5 1.5h-13A1.5 1.5 0 010 13.5v-11zM5.7 5c-.65 0-1.2.08-1.65.22v5.38h1.3v-2h.45c1.5 0 2.55-.65 2.55-1.85S7.2 5 5.7 5zm.05 2.5h-.4V6.1c.1-.02.25-.04.4-.04.6 0 1 .28 1 .72 0 .5-.4.72-1 .72zM11.2 7.3c-.35-.2-.85-.3-1.4-.3-.6 0-1.05.12-1.4.33v.95c.35-.25.8-.4 1.3-.4.45 0 .65.12.65.35 0 .22-.1.32-.7.52-.85.28-1.35.65-1.35 1.4 0 .75.55 1.25 1.35 1.25.45 0 .82-.12 1.1-.35l.1.25h1.1v-2.6c0-.72-.28-1.15-.75-1.4zm-.45 2.9c-.18.15-.42.24-.7.24-.35 0-.55-.18-.55-.45 0-.3.15-.45.65-.62.35-.12.5-.18.6-.28v1.1z"/>`,
    '#3572A5'
  ),
  sh: svg(
    `<path d="M0 2.5A1.5 1.5 0 011.5 1h13A1.5 1.5 0 0116 2.5v11a1.5 1.5 0 01-1.5 1.5h-13A1.5 1.5 0 010 13.5v-11zM3.5 5l3 3-3 3 1.1 1L8 8 4.6 4 3.5 5zM8.5 11H13v1H8.5v-1z"/>`,
    '#89e051'
  ),
  ray: svg(
    `<path d="M8 1L1 5v6l7 4 7-4V5L8 1zm0 2l4.5 2.5L8 8 3.5 5.5 8 3zM3 6.5l4.5 2.5v4.5L3 11V6.5zm10 0V11l-4.5 2.5V9L13 6.5z"/>`,
    '#c084fc'
  ),
};

export function fileIcon(name: string, isDirectory: boolean): string {
  if (isDirectory) return FOLDER;
  const ext = name.includes('.') ? name.split('.').pop()!.toLowerCase() : '';
  return icons[ext] || FILE_GENERIC;
}

// ---- Access permission icons ----

const ACCESS_PUBLIC_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="12" height="12" fill="rgba(255,255,255,0.2)"><path d="M415.9 344L225 344C227.9 408.5 242.2 467.9 262.5 511.4C273.9 535.9 286.2 553.2 297.6 563.8C308.8 574.3 316.5 576 320.5 576C324.5 576 332.2 574.3 343.4 563.8C354.8 553.2 367.1 535.8 378.5 511.4C398.8 467.9 413.1 408.5 416 344zM224.9 296L415.8 296C413 231.5 398.7 172.1 378.4 128.6C367 104.2 354.7 86.8 343.3 76.2C332.1 65.7 324.4 64 320.4 64C316.4 64 308.7 65.7 297.5 76.2C286.1 86.8 273.8 104.2 262.4 128.6C242.1 172.1 227.8 231.5 224.9 296zM176.9 296C180.4 210.4 202.5 130.9 234.8 78.7C142.7 111.3 74.9 195.2 65.5 296L176.9 296zM65.5 344C74.9 444.8 142.7 528.7 234.8 561.3C202.5 509.1 180.4 429.6 176.9 344L65.5 344zM463.9 344C460.4 429.6 438.3 509.1 406 561.3C498.1 528.6 565.9 444.8 575.3 344L463.9 344zM575.3 296C565.9 195.2 498.1 111.3 406 78.7C438.3 130.9 460.4 210.4 463.9 296L575.3 296z"/></svg>`;

const ACCESS_LOCAL_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="12" height="12" fill="#f87171"><path d="M256 8C119.034 8 8 119.033 8 256s111.034 248 248 248 248-111.034 248-248S392.967 8 256 8zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676zM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676z"/></svg>`;

const ACCESS_PRIVATE_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="12" height="12" fill="#fb923c"><path d="M256 160L256 224L384 224L384 160C384 124.7 355.3 96 320 96C284.7 96 256 124.7 256 160zM192 224L192 160C192 89.3 249.3 32 320 32C390.7 32 448 89.3 448 160L448 224C483.3 224 512 252.7 512 288L512 512C512 547.3 483.3 576 448 576L192 576C156.7 576 128 547.3 128 512L128 288C128 252.7 156.7 224 192 224z"/></svg>`;

const ACCESS_NPC_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="-16 -16 672 672" width="12" height="12" fill="rgba(255,255,255,0.2)"><!--!Font Awesome Free v7.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path d="M352 64C352 46.3 337.7 32 320 32C302.3 32 288 46.3 288 64L288 128L192 128C139 128 96 171 96 224L96 448C96 501 139 544 192 544L448 544C501 544 544 501 544 448L544 224C544 171 501 128 448 128L352 128L352 64zM160 432C160 418.7 170.7 408 184 408L216 408C229.3 408 240 418.7 240 432C240 445.3 229.3 456 216 456L184 456C170.7 456 160 445.3 160 432zM280 432C280 418.7 290.7 408 304 408L336 408C349.3 408 360 418.7 360 432C360 445.3 349.3 456 336 456L304 456C290.7 456 280 445.3 280 432zM400 432C400 418.7 410.7 408 424 408L456 408C469.3 408 480 418.7 480 432C480 445.3 469.3 456 456 456L424 456C410.7 456 400 445.3 400 432zM224 240C250.5 240 272 261.5 272 288C272 314.5 250.5 336 224 336C197.5 336 176 314.5 176 288C176 261.5 197.5 240 224 240zM368 288C368 261.5 389.5 240 416 240C442.5 240 464 261.5 464 288C464 314.5 442.5 336 416 336C389.5 336 368 314.5 368 288zM64 288C64 270.3 49.7 256 32 256C14.3 256 0 270.3 0 288L0 384C0 401.7 14.3 416 32 416C49.7 416 64 401.7 64 384L64 288zM608 256C590.3 256 576 270.3 576 288L576 384C576 401.7 590.3 416 608 416C625.7 416 640 401.7 640 384L640 288C640 270.3 625.7 256 608 256z"/></svg>`;

const ACCESS_PLAYER_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="12" height="12" fill="rgba(255,255,255,0.2)"><!--!Font Awesome Free v7.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path d="M320 312C386.3 312 440 258.3 440 192C440 125.7 386.3 72 320 72C253.7 72 200 125.7 200 192C200 258.3 253.7 312 320 312zM290.3 368C191.8 368 112 447.8 112 546.3C112 562.7 125.3 576 141.7 576L498.3 576C514.7 576 528 562.7 528 546.3C528 447.8 448.2 368 349.7 368L290.3 368z"/></svg>`;

const EVERYONE_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="-16 -16 672 672" width="12" height="12" fill="#fb923c"><!--!Font Awesome Free v7.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2026 Fonticons, Inc.--><path d="M320 80C377.4 80 424 126.6 424 184C424 241.4 377.4 288 320 288C262.6 288 216 241.4 216 184C216 126.6 262.6 80 320 80zM96 152C135.8 152 168 184.2 168 224C168 263.8 135.8 296 96 296C56.2 296 24 263.8 24 224C24 184.2 56.2 152 96 152zM0 480C0 409.3 57.3 352 128 352C140.8 352 153.2 353.9 164.9 357.4C132 394.2 112 442.8 112 496L112 512C112 523.4 114.4 534.2 118.7 544L32 544C14.3 544 0 529.7 0 512L0 480zM521.3 544C525.6 534.2 528 523.4 528 512L528 496C528 442.8 508 394.2 475.1 357.4C486.8 353.9 499.2 352 512 352C582.7 352 640 409.3 640 480L640 512C640 529.7 625.7 544 608 544L521.3 544zM472 224C472 184.2 504.2 152 544 152C583.8 152 616 184.2 616 224C616 263.8 583.8 296 544 296C504.2 296 472 263.8 472 224zM160 496C160 407.6 231.6 336 320 336C408.4 336 480 407.6 480 496L480 512C480 529.7 465.7 544 448 544L192 544C174.3 544 160 529.7 160 512L160 496z"/></svg>`;

const ACCESS_ENCRYPTED_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="12" height="12" fill="#fb923c"><path d="M400 416C497.2 416 576 337.2 576 240C576 142.8 497.2 64 400 64C302.8 64 224 142.8 224 240C224 258.7 226.9 276.8 232.3 293.7L71 455C66.5 459.5 64 465.6 64 472L64 552C64 565.3 74.7 576 88 576L168 576C181.3 576 192 565.3 192 552L192 512L232 512C245.3 512 256 501.3 256 488L256 448L296 448C302.4 448 308.5 445.5 313 441L346.3 407.7C363.2 413.1 381.3 416 400 416zM440 160C462.1 160 480 177.9 480 200C480 222.1 462.1 240 440 240C417.9 240 400 222.1 400 200C400 177.9 417.9 160 440 160z"/></svg>`;

const ACCESS_ENCRYPTED_SVG_LARGE = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640" width="16" height="16" fill="#fb923c"><path d="M400 416C497.2 416 576 337.2 576 240C576 142.8 497.2 64 400 64C302.8 64 224 142.8 224 240C224 258.7 226.9 276.8 232.3 293.7L71 455C66.5 459.5 64 465.6 64 472L64 552C64 565.3 74.7 576 88 576L168 576C181.3 576 192 565.3 192 552L192 512L232 512C245.3 512 256 501.3 256 488L256 448L296 448C302.4 448 308.5 445.5 313 441L346.3 407.7C363.2 413.1 381.3 416 400 416zM440 160C462.1 160 480 177.9 480 200C480 222.1 462.1 240 440 240C417.9 240 400 222.1 400 200C400 177.9 417.9 160 440 160z"/></svg>`;

export function accessSvg(level: string): string {
  switch (level) {
    case 'local': return ACCESS_LOCAL_SVG;
    case 'private': return ACCESS_PRIVATE_SVG;
    case 'npc': return ACCESS_NPC_SVG;
    case 'player': return ACCESS_PLAYER_SVG;
    case 'everyone': return EVERYONE_SVG;
    default: return ACCESS_PUBLIC_SVG;
  }
}

export function accessIcon(entry: { access?: string; encrypted?: boolean }): string {
  const level = entry.access || 'public';
  return `<span class="access-badge" data-access="${level}">${accessSvg(level)}</span>`;
}

export function fileOrEncryptedIcon(entry: { name: string; isDirectory: boolean; encrypted?: boolean }): string {
  if (entry.encrypted) return ACCESS_ENCRYPTED_SVG_LARGE;
  return fileIcon(entry.name, entry.isDirectory);
}
